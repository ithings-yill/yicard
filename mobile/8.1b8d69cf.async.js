(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{6:function(e,t){},7:function(e,t){},BrIs:function(e,t,a){"use strict";var n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.YIcon=void 0,a("puyI");var l=n(a("xZH1"));a("5aHp");var s=n(a("dzEL"));a("+GAu");var r=n(a("qi3o"));a("14J3");var o=n(a("BMrR"));a("jCWc");var d=n(a("kPKH"));a("XCdk");var i=n(a("b+ud"));a("AcIj");var u=n(a("Vz9s"));a("R9oj");var c=n(a("ECub"));a("QE6f");var f=n(a("Xo8F"));a("5NDa");var p=n(a("5rEg"));a("+L6B");var m=n(a("2/Rp"));a("HVTF");var h=n(a("OT5E")),g=n(a("2Taf")),v=n(a("vZ4D")),y=n(a("rlhR")),w=n(a("MhPg")),E=n(a("l4Ni")),S=n(a("ujKo")),b=n(a("p0pE"));a("e3Tq");var C=n(a("n+tp"));a("Pwec");var I,k,x=n(a("CtXQ")),N=M(a("q1tI")),O=a("MuoO"),P=n(a("3a4m")),T=n(a("9XZ3")),j=n(a("1jTp")),B=n(a("cQkz"));function D(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(D=function(e){return e?a:t})(e)}function M(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=D(t);if(a&&a.has(e))return a.get(e);var n={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var r=l?Object.getOwnPropertyDescriptor(e,s):null;r&&(r.get||r.set)?Object.defineProperty(n,s,r):n[s]=e[s]}return n.default=e,a&&a.set(e,n),n}function R(e){var t=q();return function(){var a,n=(0,S.default)(e);if(t){var l=(0,S.default)(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return(0,E.default)(this,a)}}function q(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var L=x.default.createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1173735_687r3j3wnax.js"});t.YIcon=L;var A=C.default.Item,F="smsHistory",J="smsPwd",z="smTemplate",_=5,H=(I=(0,O.connect)(function(e){var t=e.renewmodel,a=e.loading;return(0,b.default)({},t,{querying:a.effects["renewmodel/get"]})}),I(k=function(e){(0,w.default)(a,e);var t=R(a);function a(e){var n;return(0,g.default)(this,a),n=t.call(this,e),n.queryVerification=function(){var e=n.state.password;if(!e||e.length<6)h.default.fail("\u670d\u52a1\u5bc6\u7801\u957f\u5ea6\u81f3\u5c116\u4f4d",1);else{var t=n.props,a=t.dispatch,l=t.match.params.id,s=(0,y.default)(n);if(l){h.default.loading("\u6570\u636e\u67e5\u8be2\u4e2d...");var r=(new T.default).update(e).digest("hex").toLowerCase();a({type:"renewmodel/queryVerification",payload:{msisdn:l,password:r}}).then(function(){h.default.hide();var t=s.props.servicePwdVerification;t?(s.setState({visible:!1}),s.storePwd(l,e),s.loadData(0,!0)):(h.default.fail("\u670d\u52a1\u5bc6\u7801\u9519\u8bef",3),s.setState({visible:!0,password:null}))})}}},n.storePwd=function(e,t){var a=JSON.parse(localStorage.getItem(J))||[],n=a.findIndex(function(t){return t.msisdn===e});n>-1&&a.splice(n,1),a.unshift({msisdn:e,password:t}),a.length>30&&a.pop(),localStorage.setItem(J,JSON.stringify(a))},n.loadPwd=function(e){var t=JSON.parse(localStorage.getItem(J))||[],a=t.findIndex(function(t){return t.msisdn===e});return a>-1?t[a].password:null},n.queryCheck=function(){var e=n.props,t=e.dispatch,a=e.match.params.id,l=(0,y.default)(n);a&&(h.default.loading("\u6570\u636e\u67e5\u8be2\u4e2d..."),t({type:"renewmodel/queryCheck",payload:{msisdn:a}}).then(function(){h.default.hide();var e=l.props.servicePwdCheck;if(e){var t=l.loadPwd(a);t?l.setState({password:t},function(){l.queryVerification()}):l.setState({visible:!0})}else l.setState({visible:!1}),l.loadData(0,!0)}))},n.handleSubmit=function(){var e=n.props.dispatch,t=n.state,a=t.msisdn,l=t.message,s=t.password;if(l)if(l.length>2e3)h.default.fail("\u77ed\u4fe1\u5185\u5bb9\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc72000\u4e2a\u5b57\u7b26",1);else{var r=s?(new T.default).update(s).digest("hex").toLowerCase():null,o={message:l,cNos:[a],password:r};e({type:"renewmodel/smsend",payload:o}).then(function(){n.addItem(l),n.setState({message:""});var e=JSON.parse(localStorage.getItem(F))||[],t=e.findIndex(function(e){return e===a});t>-1&&e.splice(t,1),e.unshift(a),e.length>30&&e.pop(),localStorage.setItem(F,JSON.stringify(e)),n.loadData(0,!0)})}else h.default.fail("\u77ed\u4fe1\u5185\u5bb9\u5fc5\u586b",1)},n.addItem=function(e){var t=JSON.parse(localStorage.getItem(z))||[],a=t.findIndex(function(t){return t===e});a<0&&(t.length>=_&&t.splice(t.length-1,1),t.unshift(e),n.setState({datas:t}),localStorage.setItem(z,JSON.stringify(t)))},n.onRefresh=function(){var e=n.state,t=e.pages,a=e.pageIndex;a+1<t?(n.setState({refreshing:!0,loaded:!1}),n.loadData(a+1,!1)):n.setState({loaded:!1})},n.loadData=function(e,t){var a=n.state,l=a.msisdn,s=a.pageSize,r=a.datas,o=a.password,d=n.props.dispatch,i=l;if(!i){var u=n.props.match.params.id;i=u}var c=o?(new T.default).update(o).digest("hex").toLowerCase():null;d({type:"renewmodel/page",payload:{cNo:i,pageIndex:e,pageSize:s,password:c}}).then(function(){t||n.setState({refreshing:!1});var a=n.props.smdatas;a&&a.list&&(t?n.setState({datas:a.list}):n.setState({datas:r.concat(a.list)})),a&&a.pagination&&n.setState({pages:parseInt((a.pagination.total+s-1)/s,0),pageIndex:e})})},n.reLoad=function(){n.loadData(0,!0)},n.handleChange=function(e){n.setState({message:e,open:!1})},n.handleBack=function(){P.default.goBack()},n.toCopy=function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),h.default.success("\u5df2\u7ecf\u6210\u529f\u590d\u5236",1)},n.handleMessage=function(e){if(!e)return null;var t=[];return e.map(function(e,a){t.push(N.default.createElement("li",{className:1===e.sType?"":j.default.imchatmine,key:a},N.default.createElement("div",{className:1===e.sType?j.default.dateleft:j.default.dateright},e.cDate),N.default.createElement("div",{className:j.default.imchatuser},N.default.createElement(L,{type:1===e.sType?"icon-send":"icon-receive1",style:{fontSize:"25px",color:1===e.sType?"#F58B41":"#1890FF"}})),N.default.createElement("div",{className:j.default.imchattext},4===e.state?"******":e.content,"\u3010",e.stateTxt,"\u3011",N.default.createElement("p",{style:{textAlign:"right",height:5}},N.default.createElement(m.default,{icon:"copy",type:"dashed",block:!0,style:{width:70},size:"small",onClick:function(){return n.toCopy(e.content)}},"\u590d\u5236")))))}),t},n.onOpenChange=function(){var e=n.state.open;n.setState({open:!e})},n.onFocus=function(){var e=n.state.message;e||n.setState({open:!0})},n.onSelect=function(e){e&&(n.setState({message:e}),n.setState({open:!1}))},n.onChange=function(e){n.setState({password:e})},n.state={msisdn:null,message:"",refreshing:!1,datas:[],pageIndex:0,pages:1,pageSize:10,loaded:!1,open:!1,visible:!1,password:null},n}return(0,v.default)(a,[{key:"componentDidMount",value:function(){window.scrollTo(0,0);var e=this.props.match.params.id;e&&(this.setState({msisdn:e}),this.queryCheck())}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e({type:"renewmodel/clearRenew"})}},{key:"render",value:function(){var e=this,t=this.state,a=t.msisdn,n=t.message,h=t.datas,g=t.refreshing,v=t.loaded,y=t.open,w=t.pages,E=t.pageIndex,S=t.visible,b=t.password;return N.default.createElement("div",null,N.default.createElement("div",{className:j.default.smstop},N.default.createElement(A,{align:"middle",style:{marginTop:"10px",background:"#EBEBEB"}},N.default.createElement(f.default,null,N.default.createElement(f.default.Item,{className:j.default.felxImg},N.default.createElement(m.default,{style:{width:6,height:40,verticalAlign:"top"},onClick:this.handleBack},N.default.createElement(x.default,{style:{marginLeft:-6},type:"left"})),N.default.createElement(p.default,{disabled:!0,addonBefore:"\u5361\u53f7",value:a}),N.default.createElement(m.default,{style:{marginLeft:2,marginTop:3},icon:"reload",shape:"circle",onClick:this.reLoad}))))),N.default.createElement("div",{className:j.default.smslist},h&&h.length>0?N.default.createElement(N.default.Fragment,null,N.default.createElement("ul",null,this.handleMessage(h)),N.default.createElement(m.default,{type:"dashed",block:!0,loading:g,onClick:this.onRefresh,disabled:E+1>=w},E+1<w?"\u52a0\u8f7d\u66f4\u591a":"\u6ca1\u6709\u66f4\u591a\u4e86")):N.default.createElement(c.default,{image:c.default.PRESENTED_IMAGE_SIMPLE})),N.default.createElement("div",{className:j.default.smsbottom},N.default.createElement(u.default,{style:{display:v?"block":"none"},icon:null},"\u5df2\u7ecf\u52a0\u8f7d\u5168\u90e8\u6570\u636e"),N.default.createElement(o.default,{align:"middle",type:"flex"},N.default.createElement(d.default,{span:20,className:j.default.amlistsms},N.default.createElement(i.default,{value:n,placeholder:"\u77ed\u4fe1\u5185\u5bb9",rows:2,count:2e3,onChange:this.handleChange,onFocus:this.onFocus,clear:!0})),N.default.createElement(d.default,{span:4},N.default.createElement("div",{className:j.default.smsImg,onClick:this.handleSubmit})))),y&&N.default.createElement("div",null,N.default.createElement(r.default,{style:{minHeight:document.documentElement.clientHeight},contentStyle:{color:"#A6A6A6",textAlign:"center",paddingTop:50},sidebar:N.default.createElement(B.default,{onSelect:this.onSelect}),open:y,onOpenChange:this.onOpenChange}," ")),N.default.createElement(l.default,{visible:S,transparent:!0,maskClosable:!1,title:"\u670d\u52a1\u5bc6\u7801",footer:[{text:"\u786e\u8ba4",onPress:function(){e.queryVerification()}}]},N.default.createElement(s.default,{value:b,type:"password",placeholder:"\u8bf7\u8f93\u5165\u670d\u52a1\u5bc6\u7801",onChange:this.onChange,clear:!0,maxLength:6})))}}]),a}(N.Component))||k),V=H;t.default=V}}]);