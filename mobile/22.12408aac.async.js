(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{5:function(e,t){},6:function(e,t){},BrIs:function(e,t,a){"use strict";var n=a("TqRt"),l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.YIcon=void 0,a("puyI");var s=n(a("xZH1"));a("5aHp");var d=n(a("dzEL"));a("+GAu");var o=n(a("qi3o"));a("14J3");var i=n(a("BMrR"));a("jCWc");var r=n(a("kPKH"));a("XCdk");var u=n(a("b+ud"));a("AcIj");var c=n(a("Vz9s"));a("R9oj");var f=n(a("ECub"));a("QE6f");var p=n(a("Xo8F"));a("5NDa");var m=n(a("5rEg"));a("+L6B");var h=n(a("2/Rp"));a("HVTF");var g=n(a("OT5E")),v=n(a("lwsE")),y=n(a("W8MJ")),w=n(a("a1gu")),E=n(a("Nsbk")),S=n(a("7W2i")),C=n(a("PJYZ")),I=n(a("MVZn"));a("e3Tq");var b=n(a("n+tp"));a("Pwec");var k,x,N=n(a("CtXQ")),T=l(a("q1tI")),P=a("MuoO"),O=n(a("usdK")),q=n(a("9XZ3")),J=n(a("1jTp")),B=n(a("cQkz")),L=N.default.createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1173735_687r3j3wnax.js"});t.YIcon=L;var A=b.default.Item,D="smsHistory",F="smsPwd",M="smTemplate",z=5,R=(k=(0,P.connect)(function(e){var t=e.renewmodel,a=e.loading;return(0,I.default)({},t,{querying:a.effects["renewmodel/get"]})}),k(x=function(e){function t(e){var a;return(0,v.default)(this,t),a=(0,w.default)(this,(0,E.default)(t).call(this,e)),a.queryVerification=function(){var e=a.state.password;if(!e||e.length<6)g.default.fail("\u670d\u52a1\u5bc6\u7801\u957f\u5ea6\u81f3\u5c116\u4f4d",1);else{var t=a.props,n=t.dispatch,l=t.match.params.id,s=(0,C.default)((0,C.default)(a));if(l){g.default.loading("\u6570\u636e\u67e5\u8be2\u4e2d...");var d=(new q.default).update(e).digest("hex").toLowerCase();n({type:"renewmodel/queryVerification",payload:{msisdn:l,password:d}}).then(function(){g.default.hide();var t=s.props.servicePwdVerification;t?(s.setState({visible:!1}),s.storePwd(l,e),s.loadData(0,!0)):(g.default.fail("\u670d\u52a1\u5bc6\u7801\u9519\u8bef",3),s.setState({visible:!0,password:null}))})}}},a.storePwd=function(e,t){var a=JSON.parse(localStorage.getItem(F))||[],n=a.findIndex(function(t){return t.msisdn===e});n>-1&&a.splice(n,1),a.unshift({msisdn:e,password:t}),a.length>30&&a.pop(),localStorage.setItem(F,JSON.stringify(a))},a.loadPwd=function(e){var t=JSON.parse(localStorage.getItem(F))||[],a=t.findIndex(function(t){return t.msisdn===e});return a>-1?t[a].password:null},a.queryCheck=function(){var e=a.props,t=e.dispatch,n=e.match.params.id,l=(0,C.default)((0,C.default)(a));n&&(g.default.loading("\u6570\u636e\u67e5\u8be2\u4e2d..."),t({type:"renewmodel/queryCheck",payload:{msisdn:n}}).then(function(){g.default.hide();var e=l.props.servicePwdCheck;if(e){var t=l.loadPwd(n);t?l.setState({password:t},function(){l.queryVerification()}):l.setState({visible:!0})}else l.setState({visible:!1}),l.loadData(0,!0)}))},a.handleSubmit=function(){var e=a.props.dispatch,t=a.state,n=t.msisdn,l=t.message,s=t.password;if(l)if(l.length>2e3)g.default.fail("\u77ed\u4fe1\u5185\u5bb9\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc72000\u4e2a\u5b57\u7b26",1);else{var d=s?(new q.default).update(s).digest("hex").toLowerCase():null,o={message:l,cNos:[n],password:d};e({type:"renewmodel/smsend",payload:o}).then(function(){a.addItem(l),a.setState({message:""});var e=JSON.parse(localStorage.getItem(D))||[],t=e.findIndex(function(e){return e===n});t>-1&&e.splice(t,1),e.unshift(n),e.length>30&&e.pop(),localStorage.setItem(D,JSON.stringify(e)),a.loadData(0,!0)})}else g.default.fail("\u77ed\u4fe1\u5185\u5bb9\u5fc5\u586b",1)},a.addItem=function(e){var t=JSON.parse(localStorage.getItem(M))||[],n=t.findIndex(function(t){return t===e});n<0&&(t.length>=z&&t.splice(t.length-1,1),t.unshift(e),a.setState({datas:t}),localStorage.setItem(M,JSON.stringify(t)))},a.onRefresh=function(){var e=a.state,t=e.pages,n=e.pageIndex;n+1<t?(a.setState({refreshing:!0,loaded:!1}),a.loadData(n+1,!1)):a.setState({loaded:!1})},a.loadData=function(e,t){var n=a.state,l=n.msisdn,s=n.pageSize,d=n.datas,o=n.password,i=a.props.dispatch,r=l;if(!r){var u=a.props.match.params.id;r=u}var c=o?(new q.default).update(o).digest("hex").toLowerCase():null;i({type:"renewmodel/page",payload:{cNo:r,pageIndex:e,pageSize:s,password:c}}).then(function(){t||a.setState({refreshing:!1});var n=a.props.smdatas;n&&n.list&&(t?a.setState({datas:n.list}):a.setState({datas:d.concat(n.list)})),n&&n.pagination&&a.setState({pages:parseInt((n.pagination.total+s-1)/s,0),pageIndex:e})})},a.reLoad=function(){a.loadData(0,!0)},a.handleChange=function(e){a.setState({message:e,open:!1})},a.handleBack=function(){O.default.goBack()},a.toCopy=function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),g.default.success("\u5df2\u7ecf\u6210\u529f\u590d\u5236",1)},a.handleMessage=function(e){if(!e)return null;var t=[];return e.map(function(e,n){t.push(T.default.createElement("li",{className:1===e.sType?"":J.default.imchatmine,key:n},T.default.createElement("div",{className:1===e.sType?J.default.dateleft:J.default.dateright},e.cDate),T.default.createElement("div",{className:J.default.imchatuser},T.default.createElement(L,{type:1===e.sType?"icon-send":"icon-receive1",style:{fontSize:"25px",color:1===e.sType?"#F58B41":"#1890FF"}})),T.default.createElement("div",{className:J.default.imchattext},4===e.state?"******":e.content,"\u3010",e.stateTxt,"\u3011",T.default.createElement("p",{style:{textAlign:"right",height:5}},T.default.createElement(h.default,{icon:"copy",type:"dashed",block:!0,style:{width:70},size:"small",onClick:function(){return a.toCopy(e.content)}},"\u590d\u5236")))))}),t},a.onOpenChange=function(){var e=a.state.open;a.setState({open:!e})},a.onFocus=function(){var e=a.state.message;e||a.setState({open:!0})},a.onSelect=function(e){e&&(a.setState({message:e}),a.setState({open:!1}))},a.onChange=function(e){a.setState({password:e})},a.state={msisdn:null,message:"",refreshing:!1,datas:[],pageIndex:0,pages:1,pageSize:10,loaded:!1,open:!1,visible:!1,password:null},a}return(0,S.default)(t,e),(0,y.default)(t,[{key:"componentDidMount",value:function(){window.scrollTo(0,0);var e=this.props.match.params.id;e&&(this.setState({msisdn:e}),this.queryCheck())}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e({type:"renewmodel/clearRenew"})}},{key:"render",value:function(){var e=this,t=this.state,a=t.msisdn,n=t.message,l=t.datas,g=t.refreshing,v=t.loaded,y=t.open,w=t.pages,E=t.pageIndex,S=t.visible,C=t.password;return T.default.createElement("div",null,T.default.createElement("div",{className:J.default.smstop},T.default.createElement(A,{align:"middle",style:{marginTop:"10px",background:"#EBEBEB"}},T.default.createElement(p.default,null,T.default.createElement(p.default.Item,{className:J.default.felxImg},T.default.createElement(h.default,{style:{width:6,height:40,verticalAlign:"top"},onClick:this.handleBack},T.default.createElement(N.default,{style:{marginLeft:-6},type:"left"})),T.default.createElement(m.default,{disabled:!0,addonBefore:"\u5361\u53f7",value:a}),T.default.createElement(h.default,{style:{marginLeft:2,marginTop:3},icon:"reload",shape:"circle",onClick:this.reLoad}))))),T.default.createElement("div",{className:J.default.smslist},l&&l.length>0?T.default.createElement(T.default.Fragment,null,T.default.createElement("ul",null,this.handleMessage(l)),T.default.createElement(h.default,{type:"dashed",block:!0,loading:g,onClick:this.onRefresh,disabled:E+1>=w},E+1<w?"\u52a0\u8f7d\u66f4\u591a":"\u6ca1\u6709\u66f4\u591a\u4e86")):T.default.createElement(f.default,{image:f.default.PRESENTED_IMAGE_SIMPLE})),T.default.createElement("div",{className:J.default.smsbottom},T.default.createElement(c.default,{style:{display:v?"block":"none"},icon:null},"\u5df2\u7ecf\u52a0\u8f7d\u5168\u90e8\u6570\u636e"),T.default.createElement(i.default,{align:"middle",type:"flex"},T.default.createElement(r.default,{span:20,className:J.default.amlistsms},T.default.createElement(u.default,{value:n,placeholder:"\u77ed\u4fe1\u5185\u5bb9",rows:2,count:2e3,onChange:this.handleChange,onFocus:this.onFocus,clear:!0})),T.default.createElement(r.default,{span:4},T.default.createElement("div",{className:J.default.smsImg,onClick:this.handleSubmit})))),y&&T.default.createElement("div",null,T.default.createElement(o.default,{style:{minHeight:document.documentElement.clientHeight},contentStyle:{color:"#A6A6A6",textAlign:"center",paddingTop:50},sidebar:T.default.createElement(B.default,{onSelect:this.onSelect}),open:y,onOpenChange:this.onOpenChange}," ")),T.default.createElement(s.default,{visible:S,transparent:!0,maskClosable:!1,title:"\u670d\u52a1\u5bc6\u7801",footer:[{text:"\u786e\u8ba4",onPress:function(){e.queryVerification()}}]},T.default.createElement(d.default,{value:C,type:"password",placeholder:"\u8bf7\u8f93\u5165\u670d\u52a1\u5bc6\u7801",onChange:this.onChange,clear:!0,maxLength:6})))}}]),t}(T.Component))||x),V=R;t.default=V}}]);