(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[167],{"O+wR":function(e,a,t){"use strict";var n=t("TqRt"),l=t("284h");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("14J3");var r=n(t("BMrR"));t("+L6B");var o=n(t("2/Rp"));t("jCWc");var d=n(t("kPKH"));t("5NDa");var i=n(t("5rEg")),u=n(t("MVZn"));t("2qtc");var s=n(t("kLXV"));t("/zsF");var c=n(t("PArb")),f=n(t("lwsE")),g=n(t("W8MJ")),m=n(t("a1gu")),p=n(t("Nsbk")),h=n(t("7W2i"));t("y8nQ");var M,y,b,v,x,E=n(t("Vl3Y")),w=l(t("q1tI")),z=t("LLXN"),S=n(t("KLZ9")),k=n(t("wd/R")),C=n(t("EUZL")),I=n(t("HZnN")),P=n(t("usdK")),F=t("MuoO"),N=n(t("piVC")),R=E.default.Item,D=(M=E.default.create(),y=(0,F.connect)(function(e){var a=e.user,t=e.entManager,n=e.loading;return{currentUser:a.currentUser,tableData:t.data,downloadInfo:t.downloadInfo,loading:n.effects["entManager/getPage"],downloadLoading:n.effects["entManager/download"],authPublicNoLoading:n.effects["publicno/publicnoAuth"]}}),b=I.default.Secured("/baseManager/entManager"),M(v=y(v=b((x=function(e){function a(e){var t;return(0,f.default)(this,a),t=(0,m.default)(this,(0,p.default)(a).call(this,e)),t.columns=[{width:80,key:"one",title:(0,z.formatMessage)({id:"organization.index.columns.title.serialNumber",defaultMessage:"\u5e8f\u53f7"}),render:function(e,a,n){var l=t.state,r=l.pageIndex,o=l.pageSize;return r*o+n+1}},{width:250,title:(0,z.formatMessage)({id:"organization.index.columns.title.organizationName",defaultMessage:"\u7ec4\u7ec7\u540d\u79f0"}),dataIndex:"name"},{width:150,title:(0,z.formatMessage)({id:"organization.index.columns.title.contacts",defaultMessage:"\u8054\u7cfb\u4eba"}),dataIndex:"contacts"},{width:200,title:(0,z.formatMessage)({id:"organization.index.columns.title.tel",defaultMessage:"\u7535\u8bdd"}),dataIndex:"tel"},{width:200,title:(0,z.formatMessage)({id:"organization.index.columns.title.createTime",defaultMessage:"\u521b\u5efa\u65f6\u95f4"}),dataIndex:"createTime",render:function(e){return w.default.createElement("span",null,(0,k.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{fixed:"right",title:(0,z.formatMessage)({id:"organization.index.columns.title.action",defaultMessage:"\u64cd\u4f5c"}),key:"action",render:function(e,a){var n=t.props,l=n.location.pathname,r=n.currentUser;return a.code===r.entCode?null:w.default.createElement(w.Fragment,null,w.default.createElement(I.default,{authority:[l,"publicNoAuth"]},w.default.createElement(c.default,{type:"vertical"}),a.publicnoAuth>0?w.default.createElement("a",{onClick:function(){return t.publicNoInfo(!0,a)},style:{color:"red"}},(0,z.formatMessage)({id:"organization.index.link.weChat.information",defaultMessage:"\u516c\u4f17\u53f7\u4fe1\u606f"})):w.default.createElement("a",{onClick:function(){return t.publicNoAuth(!0,a)}},(0,z.formatMessage)({id:"organization.index.link.weChat.authorize",defaultMessage:"\u516c\u4f17\u53f7\u6388\u6743"}))),w.default.createElement(I.default,{authority:[l,"user"]},w.default.createElement(c.default,{type:"vertical"}),w.default.createElement("a",{onClick:function(){return t.handleUser(!0,a)}}," ",(0,z.formatMessage)({id:"organization.index.link.user",defaultMessage:"\u7528\u6237\u6ce8\u518c"})," ")),w.default.createElement(I.default,{authority:[l,"edit"]},w.default.createElement(c.default,{type:"vertical"}),w.default.createElement("a",{onClick:function(){return t.handleUpdate(!0,a)}}," ",(0,z.formatMessage)({id:"organization.index.link.edit",defaultMessage:"\u7f16\u8f91"})," ")),w.default.createElement(I.default,{authority:[l,"delete"]},w.default.createElement(c.default,{type:"vertical"}),w.default.createElement("a",{onClick:function(){return t.handleDel(!0,a)}},(0,z.formatMessage)({id:"organization.index.link.delete",defaultMessage:"\u5220\u9664"})," ")))}}],t.handleFormCreate=function(){P.default.push("/baseManager/entmanager/create")},t.handleUpdate=function(e,a){P.default.push("/baseManager/entmanager/edit/".concat(a.id))},t.publicNoInfo=function(e,a){P.default.push("/baseManager/entmanager/publicNo/".concat(a.publicnoAuth))},t.handleAuth=function(e,a){P.default.push("/baseManager/roleManager/edit/".concat(a.role))},t.handleUser=function(e,a){P.default.push({pathname:"/baseManager/userManager/create",state:a.code})},t.publicNoAuth=function(e,a){var n=t.props.dispatch;n({type:"publicno/publicnoAuth",payload:{entCode:a.code}})},t.handleDel=function(e,a){s.default.confirm({title:(0,z.formatMessage)({id:"organization.index.modal.title",defaultMessage:"\u5220\u9664\u7ec4\u7ec7"}),content:(0,z.formatMessage)({id:"organization.index.modal.content",defaultMessage:"\u786e\u5b9a\u5220\u9664\u6b64\u7ec4\u7ec7\u5417\uff1f"}),okText:(0,z.formatMessage)({id:"organization.index.modal.okText",defaultMessage:"\u786e\u5b9a"}),cancelText:(0,z.formatMessage)({id:"organization.index.modal.cancelText",defaultMessage:"\u53d6\u6d88"}),onOk:function(){var e=t.state,n=e.selectEntKey,l=e.pageIndex,r=t.props.tableData,o=t.defalutParams(n),d=l;1===r.list.length&&d>=1&&(o.Page=d-1);var i=t.props.dispatch;i({type:"entManager/delete",payload:{record:a,pageArgs:o}})}})},t.handleStandardTableChange=function(e){var a=t.state.selectEntKey,n=t.defalutParams(a);t.setState({pageIndex:e.current-1,pageSize:e.pageSize},function(){n.pageSize=e.pageSize,n.page=e.current-1;var a=t.props.dispatch;a({type:"entManager/getPage",payload:n})})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.onSelect=function(e){if(0!==e.length){t.setState({selectEntKey:e});var a=t.defalutParams(e),n=t.props.dispatch;n({type:"entManager/getPage",payload:a})}},t.handleSearch=function(e){e.preventDefault();var a=t.props,n=a.dispatch,l=a.form;l.validateFields(function(e,a){e||t.setState({formValues:a},function(){var e=t.defalutParams();n({type:"entManager/getPage",payload:e})})})},t.handleFormReset=function(){var e=t.props,a=e.form,n=e.dispatch;a.resetFields(),t.setState({formValues:{}},function(){var e=t.defalutParams();n({type:"entManager/getPage",payload:e})})},t.download=function(){var e=t.props,a=e.dispatch,n=e.form;n.validateFields(function(e,n){e||t.setState({formValues:n},function(){var e=t.defalutParams(),n=(0,u.default)({},e,{page:0,pageSize:2e6});a({type:"entManager/download",payload:n}).then(function(){var e=t.props.downloadInfo;if(e){var a=e.list.map(function(e){return{"\u7ec4\u7ec7\u540d\u79f0":e.name,"\u8054\u7cfb\u4eba":e.contacts,"\u7535\u8bdd":e.tel,"\u521b\u5efa\u65f6\u95f4":(0,k.default)(e.createTime).format("YYYY-MM-DD HH:mm:ss")}}),n=C.default.utils.json_to_sheet(a),l=C.default.utils.book_new();C.default.utils.book_append_sheet(l,n,"\u6570\u636e"),C.default.writeFile(l,"\u7ec4\u7ec7\u6570\u636e.xlsx")}})})})},t.handleMenuClick=function(){},t.renderSearchForm=function(){var e=t.props,a=e.form.getFieldDecorator,n=e.downloadLoading;return w.default.createElement(E.default,{layout:"inline",onSubmit:t.handleSearch},w.default.createElement(r.default,{gutter:{md:8,lg:24,xl:48}},w.default.createElement(d.default,{md:8,sm:24},w.default.createElement(R,{label:(0,z.formatMessage)({id:"organization.index.lable.organizationName",defaultMessage:"\u7ec4\u7ec7\u540d\u79f0"})},a("name")(w.default.createElement(i.default,{placeholder:(0,z.formatMessage)({id:"organization.index.input.pleaseInput",defaultMessage:"\u8bf7\u8f93\u5165"})})))),w.default.createElement(d.default,{md:8,sm:24},w.default.createElement("span",{className:N.default.submitButtons},w.default.createElement(o.default,{type:"primary",htmlType:"submit",icon:"search"},(0,z.formatMessage)({id:"organization.index.button.search",defaultMessage:"\u67e5\u8be2"})),w.default.createElement(o.default,{style:{marginLeft:8},onClick:t.handleFormReset},(0,z.formatMessage)({id:"organization.index.button.reset",defaultMessage:"\u91cd\u7f6e"})),w.default.createElement(o.default,{style:{marginLeft:8},onClick:t.download,icon:"download",loading:n},(0,z.formatMessage)({id:"organization.index.button.download",defaultMessage:"\u5bfc\u51fa"}))))))},t.renderOperator=function(){var e=t.props.location.pathname;return w.default.createElement(w.Fragment,null,w.default.createElement(I.default,{authority:[e,"add"]},w.default.createElement(o.default,{icon:"plus",type:"primary",onClick:t.handleFormCreate},(0,z.formatMessage)({id:"organization.index.button.create",defaultMessage:"\u65b0\u5efa"}))))},t.state={selectEntKey:[],selectedRows:[],formValues:{},pageSize:10,pageIndex:0},t}return(0,h.default)(a,e),(0,g.default)(a,[{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e({type:"entManager/setData",payload:{list:[],pagination:{}}})}},{key:"defalutParams",value:function(e){var a=this.state,t=a.formValues,n=a.pageSize,l=a.pageIndex,r=a.selectEntKey,o={entCode:e?e[0]:r[0],KeyWord:t.name,pageSize:n,page:l,searchType:-1};return o}},{key:"render",value:function(){var e=this.props,a=e.tableData,t=e.loading,n=e.authPublicNoLoading,l=e.currentUser,r=this.state.selectedRows,o={onSelect:this.onSelect,defaultSelectedKeys:[l.entCode]},d={columns:this.columns,selectedRows:r,data:a,onChange:this.handleStandardTableChange,loading:n||t,onSelectRow:this.handleSelectRows,rowKey:"id",scroll:{x:1366}};return w.default.createElement(w.default.Fragment,null,w.default.createElement(S.default,{entpriseInit:o,tableInit:d,SearchForm:this.renderSearchForm(),Operator:this.renderOperator()}))}}]),a}(w.Component),v=x))||v)||v)||v),L=D;a.default=L},piVC:function(e,a,t){e.exports={submitButtons:"antd-pro\\pages\\-base-manager\\-ent-manager\\index-submitButtons"}}}]);