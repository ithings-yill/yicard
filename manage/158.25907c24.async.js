(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[158],{eL9R:function(e,a,t){"use strict";var n=t("TqRt"),r=t("284h");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("14J3");var l=n(t("BMrR"));t("+L6B");var s=n(t("2/Rp"));t("jCWc");var d=n(t("kPKH"));t("5NDa");var u=n(t("5rEg")),o=n(t("MVZn"));t("2qtc");var i=n(t("kLXV"));t("/zsF");var f=n(t("PArb"));t("+BJd");var c=n(t("mr32")),m=n(t("lwsE")),g=n(t("W8MJ")),p=n(t("a1gu")),h=n(t("Nsbk")),M=n(t("7W2i"));t("y8nQ");var x,v,w,y,b,E=n(t("Vl3Y")),S=r(t("q1tI")),k=n(t("KLZ9")),N=t("LLXN"),P=n(t("wd/R")),F=n(t("HZnN")),C=n(t("EUZL")),D=n(t("usdK")),R=t("MuoO"),I=n(t("wfWd")),L=E.default.Item,z=(x=E.default.create(),v=(0,R.connect)(function(e){var a=e.user,t=e.userManager,n=e.loading;return{currentUser:a.currentUser,tableData:t.data,downloadData:t.downloadData,downloadLoading:n.effects["userManager/download"],loading:n.effects["userManager/getPage"]}}),w=F.default.Secured("/baseManager/userManager"),x(y=v(y=w((b=function(e){function a(e){var t;return(0,m.default)(this,a),t=(0,p.default)(this,(0,h.default)(a).call(this,e)),t.columns=[{width:80,key:"one",title:(0,N.formatMessage)({id:"user.index.columns.title.serialNumber",defaultMessage:"\u5e8f\u53f7"}),render:function(e,a,n){var r=t.state,l=r.pageIndex,s=r.pageSize;return l*s+n+1}},{width:150,title:(0,N.formatMessage)({id:"user.index.columns.title.loginName",defaultMessage:"\u7528\u6237\u540d"}),dataIndex:"userName"},{width:150,title:(0,N.formatMessage)({id:"user.index.columns.title.name",defaultMessage:"\u663e\u793a\u540d\u79f0"}),dataIndex:"name"},{width:150,title:(0,N.formatMessage)({id:"user.index.columns.title.state",defaultMessage:"\u72b6\u6001"}),dataIndex:"statusName",render:function(e,a){var t=0===a.status?"geekblue":"volcano";return S.default.createElement(c.default,{color:t},a.statusName," ")}},{width:250,title:(0,N.formatMessage)({id:"user.index.columns.title.organization",defaultMessage:"\u5f52\u5c5e\u7ec4\u7ec7"}),dataIndex:"enterpriseName"},{width:200,title:(0,N.formatMessage)({id:"user.index.columns.title.role",defaultMessage:"\u89d2\u8272"}),dataIndex:"roleName",render:function(e,a){var t=0===a.status?"geekblue":"volcano";return S.default.createElement(c.default,{color:t},a.roleName," ")}},{width:200,title:(0,N.formatMessage)({id:"user.index.columns.title.createTime",defaultMessage:"\u521b\u5efa\u65f6\u95f4"}),dataIndex:"createTime",render:function(e){return S.default.createElement("span",null,(0,P.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{fixed:"right",key:"opt",title:(0,N.formatMessage)({id:"user.index.columns.title.action",defaultMessage:"\u64cd\u4f5c"}),render:function(e,a){var n=t.props,r=n.location.pathname,l=n.currentUser;return a.enterprise===l.enterprise?null:S.default.createElement(S.Fragment,null,S.default.createElement(F.default,{authority:[r,"resetPassword"]},S.default.createElement("a",{onClick:function(){return t.handleResetPassword(!0,a)}}," ",(0,N.formatMessage)({id:"user.index.link.changePassword",defaultMessage:"\u4fee\u6539\u5bc6\u7801"})," ")),S.default.createElement(F.default,{authority:[r,"edit"]},S.default.createElement(f.default,{type:"vertical"}),S.default.createElement("a",{onClick:function(){return t.handleUpdate(!0,a)}}," ",(0,N.formatMessage)({id:"user.index.link.edit",defaultMessage:"\u7f16\u8f91"})," ")),S.default.createElement(F.default,{authority:[r,"delete"]},l.userName!==a.userName?S.default.createElement(S.Fragment,null,S.default.createElement(f.default,{type:"vertical"}),S.default.createElement("a",{onClick:function(){return t.handleDel(!0,a)}},(0,N.formatMessage)({id:"user.index.link.delete",defaultMessage:"\u5220\u9664"})," ")):null))}}],t.handleResetPassword=function(e,a){D.default.push("/baseManager/usermanager/resetpassword/".concat(a.userName))},t.handleFormCreate=function(){D.default.push("/baseManager/usermanager/create")},t.handleUpdate=function(e,a){D.default.push("/baseManager/usermanager/edit/".concat(a.id))},t.handleDel=function(e,a){i.default.confirm({title:(0,N.formatMessage)({id:"user.index.modal.title",defaultMessage:"\u5220\u9664\u7528\u6237"}),content:(0,N.formatMessage)({id:"user.index.modal.content",defaultMessage:"\u786e\u5b9a\u5220\u9664\u6b64\u7528\u6237\u5417\uff1f"}),okText:(0,N.formatMessage)({id:"user.index.modal.okText",defaultMessage:"\u786e\u5b9a"}),cancelText:(0,N.formatMessage)({id:"user.index.modal.cancelText",defaultMessage:"\u53d6\u6d88"}),onOk:function(){var e=t.state,n=e.selectEntKey,r=e.pageIndex,l=t.props.tableData,s=t.defalutParams(n),d=r;1===l.list.length&&d>=1&&(s.Page=d-1);var u=t.props.dispatch;u({type:"userManager/delete",payload:{record:a,pageArgs:s}})}})},t.handleStandardTableChange=function(e){var a=t.state.selectEntKey,n=t.defalutParams(a);t.setState({pageIndex:e.current-1,pageSize:e.pageSize},function(){n.pageSize=e.pageSize,n.page=e.current-1;var a=t.props.dispatch;a({type:"userManager/getPage",payload:n})})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.onSelect=function(e){if(0!==e.length){t.setState({selectEntKey:e});var a=t.defalutParams(e),n=t.props.dispatch;n({type:"userManager/getPage",payload:a})}},t.handleSearch=function(e){e.preventDefault();var a=t.props,n=a.dispatch,r=a.form;r.validateFields(function(e,a){e||t.setState({formValues:a},function(){var e=t.defalutParams();n({type:"userManager/getPage",payload:e})})})},t.handleFormReset=function(){var e=t.props,a=e.form,n=e.dispatch;a.resetFields(),t.setState({formValues:{}},function(){var e=t.defalutParams();n({type:"userManager/getPage",payload:e})})},t.download=function(){var e=t.props,a=e.dispatch,n=e.form;n.validateFields(function(e,n){e||t.setState({formValues:n},function(){var e=t.defalutParams(),n=(0,o.default)({},e,{page:0,pageSize:2e6});a({type:"userManager/download",payload:n}).then(function(){var e=t.props.downloadData;if(e){var a=e.list.map(function(e){return{"\u7528\u6237\u540d":e.userName,"\u663e\u793a\u540d\u79f0":e.name,"\u72b6\u6001":e.statusName,"\u7ec4\u7ec7":e.enterpriseName,"\u89d2\u8272":e.roleName,"\u521b\u5efa\u65f6\u95f4":(0,P.default)(e.createTime).format("YYYY-MM-DD HH:mm:ss")}}),n=C.default.utils.json_to_sheet(a),r=C.default.utils.book_new();C.default.utils.book_append_sheet(r,n,"\u6570\u636e"),C.default.writeFile(r,"\u7528\u6237\u6570\u636e.xlsx")}})})})},t.handleMenuClick=function(){},t.renderSearchForm=function(){var e=t.props,a=e.form.getFieldDecorator,n=e.downloadLoading;return S.default.createElement(E.default,{layout:"inline",onSubmit:t.handleSearch},S.default.createElement(l.default,{gutter:{md:8,lg:24,xl:48},style:{marginBottom:10}},S.default.createElement(d.default,{md:8,sm:24},S.default.createElement(L,{label:(0,N.formatMessage)({id:"user.index.lable.loginName",defaultMessage:"\u7528\u6237\u540d"})},a("loginName")(S.default.createElement(u.default,{placeholder:(0,N.formatMessage)({id:"user.index.input.please.input",defaultMessage:"\u8bf7\u8f93\u5165"})})))),S.default.createElement(d.default,{md:8,sm:24},S.default.createElement(L,{label:(0,N.formatMessage)({id:"user.index.lable.name",defaultMessage:"\u663e\u793a\u540d\u79f0"})},a("name")(S.default.createElement(u.default,{placeholder:(0,N.formatMessage)({id:"user.index.input.please.input",defaultMessage:"\u8bf7\u8f93\u5165"})})))),S.default.createElement(d.default,{md:8,sm:24},S.default.createElement("span",{className:I.default.submitButtons},S.default.createElement(s.default,{type:"primary",htmlType:"submit",icon:"search"},(0,N.formatMessage)({id:"user.index.button.search",defaultMessage:"\u67e5\u8be2"})),S.default.createElement(s.default,{style:{marginLeft:8},onClick:t.handleFormReset},(0,N.formatMessage)({id:"user.index.button.reset",defaultMessage:"\u91cd\u7f6e"})),S.default.createElement(s.default,{style:{marginLeft:8},onClick:t.download,icon:"download",loading:n},(0,N.formatMessage)({id:"user.index.button.download",defaultMessage:"\u5bfc\u51fa"}))))))},t.renderOperator=function(){var e=t.props.location.pathname;return S.default.createElement(S.Fragment,null,S.default.createElement(F.default,{authority:[e,"add"]},S.default.createElement(s.default,{icon:"plus",type:"primary",onClick:t.handleFormCreate},(0,N.formatMessage)({id:"user.index.button.create",defaultMessage:"\u65b0\u5efa"}))))},t.state={selectEntKey:[],selectedRows:[],formValues:{},pageSize:10,pageIndex:0},t}return(0,M.default)(a,e),(0,g.default)(a,[{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e({type:"userManager/setData",payload:{list:[],pagination:{}}})}},{key:"defalutParams",value:function(e){var a=this.state,t=a.formValues,n=a.pageSize,r=a.selectEntKey,l={entCode:e?e[0]:r[0],loginName:t.loginName,name:t.name,pageSize:n,page:0};return l}},{key:"render",value:function(){var e=this.props,a=e.tableData,t=e.loading,n=e.currentUser,r=this.state.selectedRows,l={onSelect:this.onSelect,defaultSelectedKeys:[n.entCode]},s={columns:this.columns,selectedRows:r,data:a,onChange:this.handleStandardTableChange,loading:t,onSelectRow:this.handleSelectRows,rowKey:"id",scroll:{x:1366}};return S.default.createElement(S.default.Fragment,null,S.default.createElement(k.default,{entpriseInit:l,tableInit:s,SearchForm:this.renderSearchForm(),Operator:this.renderOperator()}))}}]),a}(S.Component),y=b))||y)||y)||y),T=z;a.default=T},wfWd:function(e,a,t){e.exports={tableListForm:"antd-pro\\pages\\-base-manager\\-user-manager\\index-tableListForm",submitButtons:"antd-pro\\pages\\-base-manager\\-user-manager\\index-submitButtons",tableAlert:"antd-pro\\pages\\-base-manager\\-user-manager\\index-tableAlert"}}}]);