(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[51],{"O+wR":function(e,t,a){"use strict";var n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var r=n(a("BMrR"));a("+L6B");var l=n(a("2/Rp"));a("jCWc");var o=n(a("kPKH"));a("5NDa");var i=n(a("5rEg")),d=n(a("p0pE"));a("2qtc");var u=n(a("kLXV"));a("/zsF");var s=n(a("PArb")),c=n(a("2Taf")),f=n(a("vZ4D")),p=n(a("MhPg")),g=n(a("l4Ni")),m=n(a("ujKo"));a("y8nQ");var h,M,y,v,b=n(a("Vl3Y")),x=D(a("q1tI")),w=a("LLXN"),E=n(a("KLZ9")),z=n(a("wd/R")),k=n(a("EUZL")),S=n(a("HZnN")),P=n(a("3a4m")),C=a("MuoO"),I=n(a("piVC"));function R(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(R=function(e){return e?a:t})(e)}function D(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=R(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var o=r?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(n,l,o):n[l]=e[l]}return n.default=e,a&&a.set(e,n),n}function F(e){var t=N();return function(){var a,n=(0,m.default)(e);if(t){var r=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,g.default)(this,a)}}function N(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var O=b.default.Item,L=(h=b.default.create(),M=(0,C.connect)(function(e){var t=e.user,a=e.entManager,n=e.loading;return{currentUser:t.currentUser,tableData:a.data,downloadInfo:a.downloadInfo,loading:n.effects["entManager/getPage"],downloadLoading:n.effects["entManager/download"],authPublicNoLoading:n.effects["publicno/publicnoAuth"]}}),y=S.default.Secured("/baseManager/entManager"),h(v=M(v=y(v=function(e){(0,p.default)(a,e);var t=F(a);function a(e){var n;return(0,c.default)(this,a),n=t.call(this,e),n.columns=[{width:80,key:"one",title:(0,w.formatMessage)({id:"organization.index.columns.title.serialNumber",defaultMessage:"\u5e8f\u53f7"}),render:function(e,t,a){var r=n.state,l=r.pageIndex,o=r.pageSize;return l*o+a+1}},{width:250,title:(0,w.formatMessage)({id:"organization.index.columns.title.organizationName",defaultMessage:"\u7ec4\u7ec7\u540d\u79f0"}),dataIndex:"name"},{width:150,title:(0,w.formatMessage)({id:"organization.index.columns.title.contacts",defaultMessage:"\u8054\u7cfb\u4eba"}),dataIndex:"contacts"},{width:200,title:(0,w.formatMessage)({id:"organization.index.columns.title.tel",defaultMessage:"\u7535\u8bdd"}),dataIndex:"tel"},{width:200,title:(0,w.formatMessage)({id:"organization.index.columns.title.createTime",defaultMessage:"\u521b\u5efa\u65f6\u95f4"}),dataIndex:"createTime",render:function(e){return x.default.createElement("span",null,(0,z.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{fixed:"right",title:(0,w.formatMessage)({id:"organization.index.columns.title.action",defaultMessage:"\u64cd\u4f5c"}),key:"action",render:function(e,t){var a=n.props,r=a.location.pathname,l=a.currentUser;return t.code===l.entCode?null:x.default.createElement(x.Fragment,null,x.default.createElement(S.default,{authority:[r,"publicNoAuth"]},x.default.createElement(s.default,{type:"vertical"}),t.publicnoAuth>0?x.default.createElement("a",{onClick:function(){return n.publicNoInfo(!0,t)},style:{color:"red"}},(0,w.formatMessage)({id:"organization.index.link.weChat.information",defaultMessage:"\u516c\u4f17\u53f7\u4fe1\u606f"})):x.default.createElement("a",{onClick:function(){return n.publicNoAuth(!0,t)}},(0,w.formatMessage)({id:"organization.index.link.weChat.authorize",defaultMessage:"\u516c\u4f17\u53f7\u6388\u6743"}))),x.default.createElement(S.default,{authority:[r,"user"]},x.default.createElement(s.default,{type:"vertical"}),x.default.createElement("a",{onClick:function(){return n.handleUser(!0,t)}}," ",(0,w.formatMessage)({id:"organization.index.link.user",defaultMessage:"\u7528\u6237\u6ce8\u518c"})," ")),x.default.createElement(S.default,{authority:[r,"edit"]},x.default.createElement(s.default,{type:"vertical"}),x.default.createElement("a",{onClick:function(){return n.handleUpdate(!0,t)}}," ",(0,w.formatMessage)({id:"organization.index.link.edit",defaultMessage:"\u7f16\u8f91"})," ")),x.default.createElement(S.default,{authority:[r,"delete"]},x.default.createElement(s.default,{type:"vertical"}),x.default.createElement("a",{onClick:function(){return n.handleDel(!0,t)}},(0,w.formatMessage)({id:"organization.index.link.delete",defaultMessage:"\u5220\u9664"})," ")))}}],n.handleFormCreate=function(){P.default.push("/baseManager/entmanager/create")},n.handleUpdate=function(e,t){P.default.push("/baseManager/entmanager/edit/".concat(t.id))},n.publicNoInfo=function(e,t){P.default.push("/baseManager/entmanager/publicNo/".concat(t.publicnoAuth))},n.handleAuth=function(e,t){P.default.push("/baseManager/roleManager/edit/".concat(t.role))},n.handleUser=function(e,t){P.default.push({pathname:"/baseManager/userManager/create",state:t.code})},n.publicNoAuth=function(e,t){var a=n.props.dispatch;a({type:"publicno/publicnoAuth",payload:{entCode:t.code}})},n.handleDel=function(e,t){u.default.confirm({title:(0,w.formatMessage)({id:"organization.index.modal.title",defaultMessage:"\u5220\u9664\u7ec4\u7ec7"}),content:(0,w.formatMessage)({id:"organization.index.modal.content",defaultMessage:"\u786e\u5b9a\u5220\u9664\u6b64\u7ec4\u7ec7\u5417\uff1f"}),okText:(0,w.formatMessage)({id:"organization.index.modal.okText",defaultMessage:"\u786e\u5b9a"}),cancelText:(0,w.formatMessage)({id:"organization.index.modal.cancelText",defaultMessage:"\u53d6\u6d88"}),onOk:function(){var e=n.state,a=e.selectEntKey,r=e.pageIndex,l=n.props.tableData,o=n.defalutParams(a),i=r;1===l.list.length&&i>=1&&(o.Page=i-1);var d=n.props.dispatch;d({type:"entManager/delete",payload:{record:t,pageArgs:o}})}})},n.handleStandardTableChange=function(e){var t=n.state.selectEntKey,a=n.defalutParams(t);n.setState({pageIndex:e.current-1,pageSize:e.pageSize},function(){a.pageSize=e.pageSize,a.page=e.current-1;var t=n.props.dispatch;t({type:"entManager/getPage",payload:a})})},n.handleSelectRows=function(e){n.setState({selectedRows:e})},n.onSelect=function(e){if(0!==e.length){n.setState({selectEntKey:e});var t=n.defalutParams(e),a=n.props.dispatch;a({type:"entManager/getPage",payload:t})}},n.handleSearch=function(e){e.preventDefault();var t=n.props,a=t.dispatch,r=t.form;r.validateFields(function(e,t){e||n.setState({formValues:t},function(){var e=n.defalutParams();a({type:"entManager/getPage",payload:e})})})},n.handleFormReset=function(){var e=n.props,t=e.form,a=e.dispatch;t.resetFields(),n.setState({formValues:{}},function(){var e=n.defalutParams();a({type:"entManager/getPage",payload:e})})},n.download=function(){var e=n.props,t=e.dispatch,a=e.form;a.validateFields(function(e,a){e||n.setState({formValues:a},function(){var e=n.defalutParams(),a=(0,d.default)({},e,{page:0,pageSize:2e6});t({type:"entManager/download",payload:a}).then(function(){var e=n.props.downloadInfo;if(e){var t=e.list.map(function(e){return{"\u7ec4\u7ec7\u540d\u79f0":e.name,"\u8054\u7cfb\u4eba":e.contacts,"\u7535\u8bdd":e.tel,"\u521b\u5efa\u65f6\u95f4":(0,z.default)(e.createTime).format("YYYY-MM-DD HH:mm:ss")}}),a=k.default.utils.json_to_sheet(t),r=k.default.utils.book_new();k.default.utils.book_append_sheet(r,a,"\u6570\u636e"),k.default.writeFile(r,"\u7ec4\u7ec7\u6570\u636e.xlsx")}})})})},n.handleMenuClick=function(){},n.renderSearchForm=function(){var e=n.props,t=e.form.getFieldDecorator,a=e.downloadLoading;return x.default.createElement(b.default,{layout:"inline",onSubmit:n.handleSearch},x.default.createElement(r.default,{gutter:{md:8,lg:24,xl:48}},x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(O,{label:(0,w.formatMessage)({id:"organization.index.lable.organizationName",defaultMessage:"\u7ec4\u7ec7\u540d\u79f0"})},t("name")(x.default.createElement(i.default,{placeholder:(0,w.formatMessage)({id:"organization.index.input.pleaseInput",defaultMessage:"\u8bf7\u8f93\u5165"})})))),x.default.createElement(o.default,{md:8,sm:24},x.default.createElement("span",{className:I.default.submitButtons},x.default.createElement(l.default,{type:"primary",htmlType:"submit",icon:"search"},(0,w.formatMessage)({id:"organization.index.button.search",defaultMessage:"\u67e5\u8be2"})),x.default.createElement(l.default,{style:{marginLeft:8},onClick:n.handleFormReset},(0,w.formatMessage)({id:"organization.index.button.reset",defaultMessage:"\u91cd\u7f6e"})),x.default.createElement(l.default,{style:{marginLeft:8},onClick:n.download,icon:"download",loading:a},(0,w.formatMessage)({id:"organization.index.button.download",defaultMessage:"\u5bfc\u51fa"}))))))},n.renderOperator=function(){var e=n.props.location.pathname;return x.default.createElement(x.Fragment,null,x.default.createElement(S.default,{authority:[e,"add"]},x.default.createElement(l.default,{icon:"plus",type:"primary",onClick:n.handleFormCreate},(0,w.formatMessage)({id:"organization.index.button.create",defaultMessage:"\u65b0\u5efa"}))))},n.state={selectEntKey:[],selectedRows:[],formValues:{},pageSize:10,pageIndex:0},n}return(0,f.default)(a,[{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e({type:"entManager/setData",payload:{list:[],pagination:{}}})}},{key:"defalutParams",value:function(e){var t=this.state,a=t.formValues,n=t.pageSize,r=t.pageIndex,l=t.selectEntKey,o={entCode:e?e[0]:l[0],KeyWord:a.name,pageSize:n,page:r,searchType:-1};return o}},{key:"render",value:function(){var e=this.props,t=e.tableData,a=e.loading,n=e.authPublicNoLoading,r=e.currentUser,l=this.state.selectedRows,o={onSelect:this.onSelect,defaultSelectedKeys:[r.entCode]},i={columns:this.columns,selectedRows:l,data:t,onChange:this.handleStandardTableChange,loading:n||a,onSelectRow:this.handleSelectRows,rowKey:"id",scroll:{x:1366}};return x.default.createElement(x.default.Fragment,null,x.default.createElement(E.default,{entpriseInit:o,tableInit:i,SearchForm:this.renderSearchForm(),Operator:this.renderOperator()}))}}]),a}(x.Component))||v)||v)||v),T=L;t.default=T},piVC:function(e,t,a){e.exports={submitButtons:"antd-pro\\pages\\-base-manager\\-ent-manager\\index-submitButtons"}}}]);