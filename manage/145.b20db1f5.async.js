(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[145],{CJl3:function(e,t,n){"use strict";var r=n("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("J+/v");var a=r(n("MoRW"));n("14J3");var l=r(n("BMrR"));n("jCWc");var o=r(n("kPKH"));n("+L6B");var i=r(n("2/Rp"));n("+BJd");var s=r(n("mr32"));n("miYZ");var c=r(n("tsqr")),d=r(n("2Taf")),u=r(n("vZ4D")),f=r(n("rlhR")),p=r(n("MhPg")),m=r(n("l4Ni")),y=r(n("ujKo")),h=r(n("p0pE"));n("y8nQ");var v=r(n("Vl3Y"));n("2qtc");var g,w,S,E,R=r(n("kLXV")),k=N(n("q1tI")),b=r(n("KLZ9")),C=r(n("HZnN")),O=n("MuoO"),x=r(n("ufQ4"));function j(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(j=function(e){return e?n:t})(e)}function N(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=j(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var o=a?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(r,l,o):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}function P(e){var t=K();return function(){var n,r=(0,y.default)(e);if(t){var a=(0,y.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,m.default)(this,n)}}function K(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var M=R.default.confirm,I=(g=v.default.create(),w=(0,O.connect)(function(e){var t=e.user,n=e.apipermission,r=e.loading;return(0,h.default)({currentUser:t.currentUser},n,{loading:r.effects["apipermission/get"]})}),S=C.default.Secured("/helpservice/apipermission"),(0,x.default)(E=g(E=w(E=S(E=function(e){(0,p.default)(n,e);var t=P(n);function n(e){var r;return(0,d.default)(this,n),r=t.call(this,e),r.columns=[{title:"\u5e8f\u53f7",render:function(e,t,n){var a=r.state,l=a.pageIndex,o=a.pageSize;return l*o+n+1}},{title:"\u6743\u9650",dataIndex:"name"},{title:"\u6388\u6743\u72b6\u6001",dataIndex:"state",render:function(e){return k.default.createElement("span",{style:{fontSize:18,color:1===e?"green":"red"}},1===e?"\u221a":"\xd7")}},{title:"\u9891\u7387",dataIndex:"accessLimit",render:function(e,t){return"".concat(t.limitSeconds,"\u79d2\u5185\u5141\u8bb8\u8bbf\u95ee").concat(e,"\u6b21")}}],r.loadData=function(e){var t=r.props.dispatch;t({type:"apipermission/get",payload:e})},r.onSelect=function(e,t){t&&t.selectedNodes&&t.selectedNodes.length>0&&(r.setState({selectEnterpriseName:t.selectedNodes[0].props.title,selectedRowKeys:[],selectedRows:[]}),r.loadAccount(t.selectedNodes[0].props.dataRef.id))},r.loadAccount=function(e){var t=r.props,n=t.dispatch,a=t.currentUser;n({type:"apipermission/clearPermissionOptions"}),r.setState({enterprise:e||a.enterprise}),n({type:"apipermission/get",payload:e||a.enterprise}),n({type:"apipermission/getToken",payload:e||a.enterprise})},r.handleSet=function(e){var t=(0,f.default)(r),n=r.state.selectedRows;if(0!==n.length){var a=n.map(function(e){return e.value}),l=r.state,o=l.enterprise,i=l.selectEnterpriseName,s={add:e,enterprise:o,permission:a};M({okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",title:"\u786e\u5b9a\u7ed9\u3010".concat(i,"\u3011").concat(e?"\u6dfb\u52a0\u6743\u9650":"\u5220\u9664\u6743\u9650","?"),onOk:function(){var e=t.props.dispatch;e({type:"apipermission/post",payload:s}).then(function(){t.setState({selectedRowKeys:[],selectedRows:[]}),t.loadData(o)})}})}else c.default.warning("\u8bf7\u5148\u52fe\u9009\u5217\u8868\u6570\u636e!")},r.toCopy=function(){var e=r.props.token,t=e;t||(t="");var n=document.createElement("textarea");n.value="".concat(t),n.setAttribute("readonly",""),n.style={position:"absolute",left:"-9999px"},document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),c.default.info("\u5df2\u7ecf\u6210\u529f\u590d\u5236")},r.handleStandardTableChange=function(e,t,n){var a=r.props.currentUser,l=r.state.enterprise,o=function(e){return Object.keys(e).map(function(t){return e[t]}).join(",")},i=Object.keys(t).reduce(function(e,n){var r=(0,h.default)({},e);return r[n]=o(t[n]),r},{});r.setState({pageSize:e.pageSize});var s=(0,h.default)({enterprise:l||a.enterprise},i);n.field&&(s.sorter="".concat(n.field,"_").concat(n.order)),r.loadData(s)},r.handleSelectRows=function(e,t){r.setState({selectedRows:e,selectedRowKeys:t})},r.state={selectedRows:[],pageSize:100,selectEnterpriseName:void 0,enterprise:void 0,pageIndex:0,selectedRowKeys:[]},r}return(0,u.default)(n,[{key:"componentDidMount",value:function(){var e=this.props.currentUser;this.setState({enterprise:e.enterprise,selectEnterpriseName:e.enterpriseName}),this.loadAccount(e.enterprise)}},{key:"renderSimpleForm",value:function(){var e=this,t=this.state,n=t.selectEnterpriseName,r=t.enterprise,a=this.props,c=a.loading,d=a.token;return k.default.createElement("div",{style:{marginLeft:10,paddingBottom:10}},k.default.createElement(v.default,{layout:"inline"},k.default.createElement(l.default,{gutter:{md:16,lg:24,xl:48}},k.default.createElement(o.default,{md:8,sm:8},k.default.createElement(s.default,{color:"magenta"},"\u76ee\u6807\u5ba2\u6237\uff1a ",n),k.default.createElement(i.default,{icon:"reload",size:"small",title:"\u91cd\u65b0\u52a0\u8f7d",loading:c,shape:"circle",onClick:function(){return e.loadData(r)}})),k.default.createElement(o.default,{md:8,sm:16},k.default.createElement(i.default,{onClick:function(){return e.handleSet(!0)},icon:"plus",type:"primary"},"\u6dfb\u52a0\u6743\u9650"),k.default.createElement(i.default,{onClick:function(){return e.handleSet(!1)},style:{marginLeft:8},icon:"delete"},"\u5220\u9664\u6743\u9650"))),k.default.createElement(l.default,{gutter:{md:16,lg:24,xl:48}},k.default.createElement(o.default,{md:8,sm:24},k.default.createElement("li",null,k.default.createElement("h6",{style:{marginRight:8,display:"inline",fontWeight:"bolder"}},"\u76ee\u6807\u5ba2\u6237API\u63a5\u53e3Token:"),k.default.createElement(s.default,{color:"magenta"},d),k.default.createElement(i.default,{type:"danger",size:"small",ghost:!0,onClick:this.toCopy},"\u590d\u5236"))))))}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.currentUser,r=e.permissionOptions,l=this.state,o=l.selectedRows,i=l.selectedRowKeys,s={onSelect:this.onSelect,defaultSelectedKeys:[n.entCode]},c=n&&n.entCode&&n.entCode.length<=4,d={selectedRows:o,columns:this.columns,data:r,onChange:this.handleStandardTableChange,loading:t,onSelectRow:this.handleSelectRows,size:"small",checkBox:!0,selectedRowKeys:i};return k.default.createElement("div",null,c?k.default.createElement("div",null,k.default.createElement(b.default,{entpriseInit:s,SearchForm:this.renderSimpleForm(),tableInit:d})):k.default.createElement(a.default,{status:"403",title:"403",subTitle:"\u62b1\u6b49\uff0c\u975e\u5361\u5546\u7ba1\u7406\u5458\uff0c\u4f60\u65e0\u6743\u8bbf\u95ee\u8be5\u9875\u9762"}))}}]),n}(k.Component))||E)||E)||E)||E),z=I;t.default=z}}]);